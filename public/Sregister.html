<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Student Registration Form</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            background-color: #c5eaff;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 150vh;
        }

        .registration-form {
            background-color: #ffffff;
            padding: 50px;
            border-radius: 10px;
            box-shadow: 0px 0px 10px rgba(0, 0, 0, 0.1);
            width: 400px;
        }

        .registration-form h2 {
            text-align: center;
            margin-bottom: 20px;
            color: #333333;
        }

        .registration-form label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
        }

        .registration-form input[type="text"],
        .registration-form input[type="email"],
        .registration-form input[type="tel"],
        .registration-form input[type="password"],
        .registration-form select {
            width: 100%;
            padding: 10px;
            margin-bottom: 15px;
            border: 1px solid #cccccc;
            border-radius: 5px;
            font-size: 16px;
        }

        .registration-form input[type="radio"] {
            margin-right: 5px;
        }

        .registration-form .gender {
            display: flex;
            justify-content: space-between;
            margin-bottom: 10px;
        }

        .registration-form .gender label {
            font-weight: normal;
        }

        .registration-form input[type="checkbox"] {
            margin-right: 10px;
        }

        .registration-form button {
            width: 100%;
            padding: 10px;
            background-color: #007bff;
            border: none;
            border-radius: 5px;
            color: #ffffff;
            font-size: 16px;
            cursor: pointer;
        }

        .registration-form button:hover {
            background-color: #0056b3;
        }

        .registration-form .agreement {
            font-size: 14px;
            margin-bottom: 20px;
            color: #666666;
        }

        .registration-form .agreement input {
            margin-right: 5px;
        }
    </style>
</head>
<body>

    <div class="registration-form">
            <h2>Student Registration</h2>
    <form id="registerForm">
      <label for="name">Full Name</label>
      <input type="text" id="name" name="name" required />

      <label for="username">Username</label>
      <input type="text" id="username" name="username" required />

      <label for="email">Email</label>
      <input type="email" id="email" name="email" required />

      <label for="phone">Phone Number</label>
      <input type="tel" id="phone" name="phone" required />

      <label for="uid">UID</label>
      <input type="tel" id="uid" name="uid" required />

      <label for="rollNumber">Roll Number</label>
      <input type="text" id="rollNumber" name="rollNumber" required />

      <label for="department">Department</label>
      <select id="department" name="department" required>
        <option value="">Select Department</option>
        <option value="IT">Information Technology</option>
        <option value="CSE">Computer Science and Engineering</option>
        <option value="ECE">Electronics and Communication Engineering</option>
        <option value="ME">Mechanical Engineering</option>
        <option value="EE">Electronics and Computer Science Engineering</option>
        <option value="CE">Civil Engineering</option>
      </select>

      <label for="year">Year of Study</label>
      <select id="year" name="year" required>
        <option value="">Select Year</option>
        <option value="1">First Year</option>
        <option value="2">Second Year</option>
        <option value="3">Third Year</option>
        <option value="4">Fourth Year</option>
      </select>

      <label for="division">Division</label>
      <select id="division" name="division" required>
        <option value="A">A</option>
        <option value="B">B</option>
      </select>

      <label for="skills">Skills (comma-separated)</label>
      <input type="text" id="skills" name="skills" placeholder="e.g., Java, Python" />

      <label>Gender:</label>
      <div class="gender">
        <label><input type="radio" name="gender" value="male" required /> Male</label>
        <label><input type="radio" name="gender" value="female" required /> Female</label>
        <label><input type="radio" name="gender" value="other" required /> Other</label>
      </div>

      <label for="password">Password</label>
      <input type="password" id="password" name="password" required />

      <label for="confirm-password">Confirm Password</label>
      <input type="password" id="confirm-password" name="confirm-password" required />

      <div class="agreement">
        <label>
          <input type="checkbox" name="agree" required />
          I agree to the <a href="#">Terms and Conditions</a>
        </label>
      </div>

      <button type="submit">Register</button>
    </form>
  </div>

  <script>
    document.getElementById('registerForm').addEventListener('submit', async function (e) {
      e.preventDefault();

      const formData = new FormData(this);
      const password = formData.get("password");
      const confirmPassword = formData.get("confirm-password");

      if (password !== confirmPassword) {
        alert("Passwords do not match.");
        return;
      }

      const skillsRaw = formData.get("skills") || "";
      const skillsArray = skillsRaw.split(',').map(s => s.trim()).filter(Boolean);

      const userData = {
        name: formData.get("name"),
        username: formData.get("username"),
        email: formData.get("email"),
        phone: formData.get("phone"),
        uid: formData.get("uid"),
        rollNumber: formData.get("rollNumber"),
        department: formData.get("department"),
        year: formData.get("year"),
        division: formData.get("division"),
        skills: skillsRaw,
        gender: formData.get("gender"),
        password: password
      };

      try {
        const response = await fetch('http://localhost:3000/api/student/signup', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify(userData)
        });

       if (!response.ok) {
  const errorText = await response.text();
  throw new Error(errorText);
}

const result = await response.json(); // Now it's safe
alert(result.message || "Registration successful!");
window.location.href = "/login.html";

       
      } catch (error) {
        
        alert("Registration failed: " + error.message);
      }
    });

        
</script>
</body>
</html>